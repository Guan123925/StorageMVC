
@{
    ViewBag.Title = "StageUpdate";
    Layout = "~/Views/Master/Project/StageUpdate.cshtml";
}

<script>
    $().ready(function () {
        StageBackFill();
    })

    function StageBackFill() {
        var PlanId = $("#hidPlanId").val();

        $.ajax({
            url: "/Project/StageBackFill",
            data: {
                PlanId: PlanId
            },
            type: "post",
            datatype: "json",
            success: function (res) {
                $(res.Stage).each(function () {
                    $("#txtStage").val(res.Stage[0].StageName);
                    $("#txtStartTime").val(res.Stage[0].StageStartTime);
                    $("#txtOffTime").val(res.Stage[0].StageFinishTime);
                    $("#txtPerson").val(res.Stage[0].StageStaffName);
                })
            }
        })
    }

    function StageUpdate() {
        var PlanId = $("#hidPlanId").val();
        var StageName = $("#txtStage").val();
        var StageStartTime = $("#txtStartTime").val();
        var StageFinishTime = $("#txtOffTime").val();
        var StageStaffName = $("#txtPerson").val();

        $.ajax({
            url: "/Project/UpdateStage",
            data: {
                PlanId: PlanId,
                StageName: StageName,
                StageStartTime:StageStartTime,
                StageFinishTime: StageFinishTime,
                StageStaffName:StageStaffName,
            },
            type:"post",
            datatype: "json",
            success: function (res) {
                if (res.IsRegistSuccess) {
                    alert("修改成功");
                    location.href = "/Project/AddProjectAndStage";
                }
                else {
                    alert("修改失败");
                    return;
                }
            }
        })
    }
</script>